<!DOCTYPE html>
<html lang="en">


    <head>

        <meta charset="utf-8" />

        <title>安全系统 - 自动化运维管理平台</title>

        <meta name="keywords" content="Bootstrap模版,Bootstrap模版下载,Bootstrap教程,Bootstrap中文" />

        <meta name="description" content="站长素材提供Bootstrap模版,Bootstrap教程,Bootstrap中文翻译等相关Bootstrap插件下载" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- basic styles -->



                <link rel="stylesheet" href='/static/assets/css/bootstrap1.min.css'>

                <link rel="stylesheet" href='/static/assets/css/font-awesome.min.css'>
                <link rel="stylesheet" href='/static/css/buttons.css'>



        <!--[if IE 7]>

          <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css" />

        <![endif]-->



        <!-- page specific plugin styles -->



        <!-- fonts -->



       <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" /> -->

        <!-- ace styles -->



                <link rel="stylesheet" href='/static/assets/css/ace.min.css'>

                <link rel="stylesheet" href='/static/assets/css/ace-rtl.min.css'>

                <link rel="stylesheet" href='/static/assets/css/ace-skins.min.css'>



        <!--[if lte IE 8]>

          <link rel="stylesheet" href="assets/css/ace-ie.min.css" />

        <![endif]-->



        <!-- inline styles related to this page -->



        <!-- ace settings handler -->



        <script src='/static/assets/js/ace-extra.min.js'></script>



        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->



        <!--[if lt IE 9]>

        <script src="assets/js/html5shiv.js"></script>

        <script src="assets/js/respond.min.js"></script>

        <![endif]-->

               <style>

ul,li{ padding:0; margin:0;list-style:none}

/*.nav1{border:1px solid #000; width:510px; overflow:hidden} */

.nav1{overflow:hidden}

.nav1 li{ line-height:22px; float:left; padding:0 5px;}

.nav1 li a:hover{ color:#F00}

        /* 对class=nav设置黑色边框，鼠标滑过超链接文字为红色 */ 



nav1{ border:1px solid #F00; width:520px; overflow:hidden}

nav1 li{line-height:22px; float:left; padding:0 6px;}

nav1 li a{ color:#F00}

        /* 对nav设置红色边框，超链接位置为红色 */ 



.nav1.bg{ background:#CCC}

.nav1.bg li a{ color:#090}

        /* 对nav设置class=bg，设置背景为灰色，超链接位置为绿色 */ 

* {
        box-sizing: border-box;
    }
    html {
        height: 100%;
    }
    body {
        background: #efeeea;
        background: linear-gradient(#f9f9f9, #cecbc4);
        background: -moz-linear-gradient(#f9f9f9, #cecbc4);
        background: -webkit-linear-gradient(#f9f9f9, #cecbc4);
        background: -o-linear-gradient(#f9f9f9, #cecbc4);
        color: #757575;
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
    }
    h1, p {
        padding:0; margin:0;
    }

    .wrapper {
        width: 350px;
       /* margin: 50px auto;*/
        margin: 20px;
    }

    .wrapper p a {color:#757570; text-decoration:none;}

    .wrapper .load-bar {
        width: 100%;
        height: 25px;
        position: relative;
        border-radius: 30px;
        background: #dcdbd7;
        box-shadow: 0 1px 0 rgba(255, 255, 255, 0.8),  inset 0 2px 3px rgba(0, 0, 0, 0.2);
    }
    .wrapper .load-bar-inner {
        height: 99%;
        width: 0%;
        border-radius: inherit;
        position: relative;
        background: #a1d7cd;
        background: linear-gradient(#a1d7cd, #2d99d7);
        background: -moz-linear-gradient(#a1d7cd, #2d99d7);
        background: -webkit-linear-gradient(#a1d7cd, #2d99d7);
        background: -o-linear-gradient(#a1d7cd, #2d99d7);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 1),  0 1px 5px rgba(0, 0, 0, 0.3),  0 4px 5px rgba(0, 0, 0, 0.3);
        animation: loader 10s linear infinite;
        -moz-animation: loader 10s linear infinite;
        -webkit-animation: loader 10s linear infinite;
        -o-animation: loader 10s linear infinite;
    }
    .wrapper h1 {
        font-size: 28px;
        padding: 20px 0 8px 0;
    }
    .wrapper p {
        font-size: 13px;
    }

</style>

    </head>




    <body>

        <div class="navbar navbar-default" id="navbar">

            <script type="text/javascript">

                try{ace.settings.check('navbar' , 'fixed')}catch(e){}

            </script>



            <div class="navbar-container" id="navbar-container">

                <div class="navbar-header pull-left">

                    <a href="#" class="navbar-brand">

                        <small>

                            <i class="icon-refresh"></i>

                            自动化运维管理平台

                        </small>

                    </a><!-- /.brand -->

                </div><!-- /.navbar-header -->



                <div class="navbar-header pull-right" role="navigation">

                    <ul class="nav ace-nav">



                        <li class="light-blue">

                            <a data-toggle="dropdown" href="#" class="dropdown-toggle">

                                <img class="nav-user-photo" src='/static/assets/avatars/user.jpg' alt="Jason's Photo" />

                                <span class="user-info">

                                    <small>欢迎您，{{ user.username }} ！</small>

                                    

                                </span>



                                <i class="icon-caret-down"></i>

                            </a>



                            <ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">

                                <li>

                                    <a href="#">

                                        <i class="icon-cog"></i>

                                        设置

                                    </a>

                                </li>



                                <li>

                                    <a href="#">

                                        <i class="icon-user"></i>

                                        个人资料

                                    </a>

                                </li>



                                <li class="divider"></li>



                                <li>

                                    <a href="/logout_user">

                                        <i class="icon-off"></i>

                                        退出

                                    </a>

                                </li>

                            </ul>

                        </li>

                    </ul><!-- /.ace-nav -->

                </div><!-- /.navbar-header -->

            </div><!-- /.container -->

        </div>



    <div class="main-container" id="main-container">

        <script type="text/javascript">

            try{ace.settings.check('main-container' , 'fixed')}catch(e){}

        </script>



        <div class="main-container-inner">

            <a class="menu-toggler" id="menu-toggler" href="#">

                <span class="menu-text"></span>

            </a>



            <div class="sidebar" id="sidebar">

                <script type="text/javascript">

                    try{ace.settings.check('sidebar' , 'fixed')}catch(e){}

                </script>



                                    <br><br>



                <ul class="nav nav-list">
                    <li>
                        <a href="service">
                            <i class="icon-dashboard"></i>
                            <span class="menu-text"> 服务台 </span>
                        </a>
                    </li>



                    <li>
                        <a href="log">
                            <i class="icon-text-width"></i>
                            <span class="menu-text"> 日志系统 </span>
                        </a>
                    </li>


                    <li>
                        <a href="#" class="dropdown-toggle">
                            <i class="icon-list"></i>
                            <span class="menu-text"> 部署</span>
                            <b class="arrow icon-angle-down"></b>
                        </a>

                        <ul class="submenu">
                            <li> 
                                <a href="/conf">
                                    <i class="icon-double-angle-right"></i>
                                    预配置
                                </a>
                            </li>


                            <li>
                                <a href="/install">
                                    <i class="icon-double-angle-right"></i>
                                    安装
                                </a>
                            </li>
                        </ul>
                    </li>



                    <li >
                        <a href="security">
                            <i class="icon-calendar"></i>


                            <span class="menu-text">

                                安全系统
                                <span class="badge badge-transparent tooltip-error" title="2&nbsp;Important&nbsp;Events">
                                    <i class="icon-warning-sign red bigger-130"></i>
                                </span>
                            </span>
                        </a>
                    </li>


                    <li class="active open">
                        <a href="#" class="dropdown-toggle">
                            <i class="icon-list"></i>
                            <span class="menu-text"> 监控系统</span>

                            <b class="arrow icon-angle-down"></b>
                        </a>

                        <ul class="submenu">
                            <li class="active"> 
                                <a href="/monitor_list">
                                    <i class="icon-double-angle-right"></i>
                                    监控主机
                                </a>
                            </li>
                            
                            <li> 
                                <a href="/monitor_info">
                                    <i class="icon-double-angle-right"></i>
                                    监控信息
                                </a>
                            </li>
                        </ul>
                    </li>


                </ul><!-- /.nav-list -->


                <div class="sidebar-collapse" id="sidebar-collapse">
                    <i class="icon-double-angle-left" data-icon1="icon-double-angle-left" data-icon2="icon-double-angle-right"></i>
                </div>



                <script type="text/javascript">
                    try{ace.settings.check('sidebar' , 'collapsed')}catch(e){}
                </script>
            </div>



            <div class="main-content">

                <div class="breadcrumbs" id="breadcrumbs">

                    <script type="text/javascript">

                        try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}

                    </script>



                    <ul class="breadcrumb">

                        <li>

                            <i class="icon-home home-icon"></i>

                            <a href="#">首页</a>

                        </li>

                        <li class="active">监控系统</li>

                    </ul><!-- .breadcrumb -->



                    <!-- <div class="nav-search" id="nav-search">

                        <form class="form-search">

                            <span class="input-icon">

                                <input type="text" placeholder="Search ..." class="nav-search-input" id="nav-search-input" autocomplete="off" />

                                <i class="icon-search nav-search-icon"></i>

                            </span>

                        </form>

                    </div>#nav-search -->

                </div>



                <div class="page-content">

                   <!-- <div class="page-header">

                        <h1>

                            部署系统

                            <small>

                                <i class="icon-double-angle-right"></i>

                                 安装

                            </small>

                        </h1>

                    </div>--> <!-- /.page-header -->






        <div class="row">

                <div class="col-xs-11">

                <!-- PAGE CONTENT BEGINS -->

                    <div class="row">

                        <div class="col-xs-12">

                            <h3 class="header smaller lighter blue">监控服务器</h3>
                            
                            
                            <button type='button' class='btn btn-info rightfloat' data-toggle="modal" data-target="#addhost" data-show="true" id='addhostButton'><span class='glyphicon glyphicon-plus'></span> 添加服务器</button>
                            <button type='button' class='btn btn-info rightfloat' data-toggle="modal" data-target="#addgroup" data-show="true" id='addgroupButton'><span class='glyphicon glyphicon-plus'></span> 添加组</button>
                            <button type='button' class='btn btn-warning rightfloat' data-toggle="modal" data-target="#delgroup" data-show="true" id='delgroupButton'><span class='glyphicon glyphicon-minus'></span> 删除组</button>
                            <div style='clear:both;'></div>
                            
                            <br/>
                            
                            <div class="table-header">
                                监控服务器列表
                            </div>

                            <div class="table-responsive" id="host">
                                <table class="table table-striped table-bordered table-hover" id='idData'>
                                  <thead>
                                    <tr>
                                        <!-- <th class="center">
                                            <label>
                                                <input type="checkbox" class="ace" id='chkall' />
                                                <span class="lbl"></span>
                                            </label>
                                        </th> -->
                                        <th width="5%">序号</th>
                                        <th width="15%">主机名称</th>
                                        <th width="15%">IP</th>
                                        <th width="15%">组</th>
                                        <th width="12%">Zabbix客户端</th>
                                        <th width="12%">ELK客户端</th>
                                        <th width="26%">操作</th>
                                    </tr>
                                  </thead>
                                  <tbody id='hostlist'></tbody>
                                </table>
                                <!--分页-->
                                <div class='paginationDiv'>
                                  <ul class="pagination"></ul>
                                </div>
                           </div>
                           
                        </div>

                    </div>

                </div><!-- /.page-content -->


                <!--添加host弹框-->
                <div class="modal fade" id="addhost" tabindex="-1" role="dialog" 
                   aria-labelledby="newFloderModalLabel" data-keyboard="false">
                   <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">添加监控主机</h4>
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal" role="form" action='javascript:addhost()'>
                            
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机名称</span>
                                    <input type="text" class="form-control" id="host_1" name="host_name" placeholder="用户自定义" style="color:blue">
                                </div>
                                <br/>
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机IP地址</span>
                                    <input type="text" class="form-control" id="host_2" name="host_ip" placeholder="正确的IPv4" style="color:blue">
                                </div>
                                <br/>
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">输入主机用户名</span>
                                    <input type="text" class="form-control" id="host_3" name="host_user" style="color:blue" placeholder="请选择root用户">
                                </div>
                                <br/>

                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">输入主机密码</span>
                                    <input type="text" class="form-control" id="host_4" name="host_passwd" style="color:blue" placeholder="默认不能为空">
                                </div>
                                <br/>
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">输入主机端口</span>
                                    <input type="text" class="form-control" id="host_5" name="host_port" style="color:blue" placeholder="默认为22">
                                </div>
                                <br/>
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">选择分组</span>
                                    <select class="form-control" id="host_6" name="host_group" placeholder="请下拉选择" style="color:blue">
                                    </select>
                                </div>
                                
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="addhost()">确定</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        </div>
                      </div> 
                    </div>
                </div>
                
                
                <!--修改host配置信息弹框-->
                <div class="modal fade" id="modifyhostinfo" tabindex="-1" role="dialog" 
                   aria-labelledby="newFloderModalLabel" data-keyboard="false">
                   <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">修改配置信息：<input type="text" readonly="readonly" id="singlehost_2" name="singlehost_ip"></h4>
                            
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal" role="form" action='javascript:modifyhost()'>
                                
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机名称</span>
                                    <input type="text" class="form-control" id="singlehost_1" name="singlehost_name" placeholder="用户自定义" style="color:blue">
                                </div>
                                <br/>
                                
                                <!-- <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机IP地址</span>
                                    <input type="text" class="form-control" id="singlehost_2" name="singlehost_ip" placeholder="正确的IPv4" style="color:blue">
                                </div>
                                <br/> -->
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机用户名</span>
                                    <input type="text" class="form-control" id="singlehost_3" name="singlehost_user" style="color:blue" placeholder="请选择root用户">
                                </div>
                                <br/>

                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机密码</span>
                                    <input type="text" class="form-control" id="singlehost_4" name="singlehost_passwd" style="color:blue" placeholder="默认不能为空">
                                </div>
                                <br/>
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">主机端口</span>
                                    <input type="text" class="form-control" id="singlehost_5" name="singlehost_port" style="color:blue" placeholder="默认为22">
                                </div>
                                <br/>
                                
                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">选择分组</span>
                                    <select class="form-control" id="singlehost_6" name="singlehost_group" placeholder="请下拉选择" style="color:blue">
                                    </select>
                                </div>
                                
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="modifyhost()">确定</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        </div>
                      </div> 
                    </div>
                </div>
                
                
                <!--添加group弹框-->
                <div class="modal fade" id="addgroup" tabindex="-1" role="dialog" 
                   aria-labelledby="newFloderModalLabel" data-keyboard="false">
                   <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">添加监控主机</h4>
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal" role="form" action='javascript:addgroup()'>

                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">输入组名</span>
                                    <input type="text" class="form-control" id="group_1" name="host_passwd" style="color:blue" placeholder="字母、数字、下划线（64位以内）">
                                </div>
                                <br/>
                                
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="addgroup()">确定</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        </div>
                      </div> 
                    </div>
                </div>
                
                
                <!--删除group弹框-->
                <div class="modal fade" id="delgroup" tabindex="-1" role="dialog" 
                   aria-labelledby="newFloderModalLabel" data-keyboard="false">
                   <div class="modal-dialog">
                      <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">添加监控主机</h4>
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal" role="form" action='javascript:delgroup()'>

                                <div class="input-group" style="left:30px;width:500px">
                                    <span class="input-group-addon" style="width:200px;text-align:left">选择分组</span>
                                    <select class="form-control" id="group_2" name="host_group" placeholder="请下拉选择" style="color:blue">
                                    </select>
                                </div>
                                <br/>
                                
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" onclick="delgroup()">确定</button>
                            <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        </div>
                      </div> 
                    </div>
                </div>

        </div><!-- /span -->
        

        <!-- basic scripts -->



        <!--[if !IE]> -->



        <!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

-->

        <!-- <![endif]-->



        <!--[if IE]>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

<![endif]-->



        <!--[if !IE]> -->



        <script type="text/javascript">

            window.jQuery || document.write("<script src='/static/assets/js/jquery-2.0.3.min.js'>"+"<"+"script>");

        </script>



        <!-- <![endif]-->



        <!--[if IE]>

<script type="text/javascript">

 window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>"+"<"+"script>");

</script>

<![endif]-->



        <script type="text/javascript">

            if("ontouchend" in document) document.write("<script src='/static/assets/js/jquery.mobile.custom.min.js'>"+"<"+"script>");

        </script>

                <script src="/static/assets/js/bootstrap.min.js"></script>

                <script src="/static/assets/js/typeahead-bs2.min.js"></script>



        <!-- page specific plugin scripts -->



        <!--[if lte IE 8]>

          <script src="assets/js/excanvas.min.js"></script>

        <![endif]-->



                <script src="/static/assets/js/jquery-ui-1.10.3.custom.min.js"></script>

                <script src="/static/assets/js/jquery.ui.touch-punch.min.js"></script>

                <script src="/static/assets/js/jquery.slimscroll.min.js"></script>

                <script src="/static/assets/js/jquery.easy-pie-chart.min.js"></script>

                <script src="/static/assets/js/jquery.sparkline.min.js"></script>

                <script src="/static/assets/js/flot/jquery.flot.min.js"></script>

                <script src="/static/assets/js/flot/jquery.flot.pie.min.js"></script>

                <script src="/static/assets/js/flot/jquery.flot.resize.min.js"></script>



        <!-- ace scripts -->



                <script src="/static/assets/js/ace-elements.min.js"></script>

                <script src="/static/assets/js/ace.min.js"></script>

              



        <!-- inline scripts related to this page -->



        <script type="text/javascript">

            jQuery(function($) {

                $('.easy-pie-chart.percentage').each(function(){

                    var $box = $(this).closest('.infobox');

                    var barColor = $(this).data('color') || (!$box.hasClass('infobox-dark') ? $box.css('color') : 'rgba(255,255,255,0.95)');

                    var trackColor = barColor == 'rgba(255,255,255,0.95)' ? 'rgba(255,255,255,0.25)' : '#E2E2E2';

                    var size = parseInt($(this).data('size')) || 50;

                    $(this).easyPieChart({

                        barColor: barColor,

                        trackColor: trackColor,

                        scaleColor: false,

                        lineCap: 'butt',

                        lineWidth: parseInt(size/10),

                        animate: /msie\s*(8|7|6)/.test(navigator.userAgent.toLowerCase()) ? false : 1000,

                        size: size

                    });

                })

            

                $('.sparkline').each(function(){

                    var $box = $(this).closest('.infobox');

                    var barColor = !$box.hasClass('infobox-dark') ? $box.css('color') : '#FFF';

                    $(this).sparkline('html', {tagValuesAttribute:'data-values', type: 'bar', barColor: barColor , chartRangeMin:$(this).data('min') || 0} );

                });


              var placeholder = $('#piechart-placeholder').css({'width':'90%' , 'min-height':'150px'});

              var data = [

                { label: "social networks",  data: 38.7, color: "#68BC31"},

                { label: "search engines",  data: 24.5, color: "#2091CF"},

                { label: "ad campaigns",  data: 8.2, color: "#AF4E96"},

                { label: "direct traffic",  data: 18.6, color: "#DA5430"},

                { label: "other",  data: 10, color: "#FEE074"}

              ]

              function drawPieChart(placeholder, data, position) {

                  $.plot(placeholder, data, {

                    series: {

                        pie: {

                            show: true,

                            tilt:0.8,

                            highlight: {

                                opacity: 0.25

                            },

                            stroke: {

                                color: '#fff',

                                width: 2

                            },

                            startAngle: 2

                        }

                    },

                    legend: {

                        show: true,

                        position: position || "ne", 

                        labelBoxBorderColor: null,

                        margin:[-30,15]

                    }

                    ,

                    grid: {

                        hoverable: true,

                        clickable: true

                    }

                 })

             }

             drawPieChart(placeholder, data);

            

             /**

             we saved the drawing function and the data to redraw with different position later when switching to RTL mode dynamically

             so that's not needed actually.

             */

             placeholder.data('chart', data);

             placeholder.data('draw', drawPieChart);

            

            

            

              var $tooltip = $("<div class='tooltip top in'><div class='tooltip-inner'></div></div>").hide().appendTo('body');

              var previousPoint = null;

            

              placeholder.on('plothover', function (event, pos, item) {

                if(item) {

                    if (previousPoint != item.seriesIndex) {

                        previousPoint = item.seriesIndex;

                        var tip = item.series['label'] + " : " + item.series['percent']+'%';

                        $tooltip.show().children(0).text(tip);

                    }

                    $tooltip.css({top:pos.pageY + 10, left:pos.pageX + 10});

                } else {

                    $tooltip.hide();

                    previousPoint = null;

                }

                

             });

            

                var d1 = [];

                for (var i = 0; i < Math.PI * 2; i += 0.5) {

                    d1.push([i, Math.sin(i)]);

                }

            

                var d2 = [];

                for (var i = 0; i < Math.PI * 2; i += 0.5) {

                    d2.push([i, Math.cos(i)]);

                }

            

                var d3 = [];

                for (var i = 0; i < Math.PI * 2; i += 0.2) {

                    d3.push([i, Math.tan(i)]);

                }

                

            

                var sales_charts = $('#sales-charts').css({'width':'100%' , 'height':'220px'});

                $.plot("#sales-charts", [

                    { label: "Domains", data: d1 },

                    { label: "Hosting", data: d2 },

                    { label: "Services", data: d3 }

                ], {

                    hoverable: true,

                    shadowSize: 0,

                    series: {

                        lines: { show: true },

                        points: { show: true }

                    },

                    xaxis: {

                        tickLength: 0

                    },

                    yaxis: {

                        ticks: 10,

                        min: -2,

                        max: 2,

                        tickDecimals: 3

                    },

                    grid: {

                        backgroundColor: { colors: [ "#fff", "#fff" ] },

                        borderWidth: 1,

                        borderColor:'#555'

                    }

                });

            

            

                $('#recent-box [data-rel="tooltip"]').tooltip({placement: tooltip_placement});

                function tooltip_placement(context, source) {

                    var $source = $(source);

                    var $parent = $source.closest('.tab-content')

                    var off1 = $parent.offset();

                    var w1 = $parent.width();

            

                    var off2 = $source.offset();

                    var w2 = $source.width();

            

                    if( parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2) ) return 'right';

                    return 'left';

                }

            

            

                $('.dialogs,.comments').slimScroll({

                    height: '300px'

                });

                

                

                //Android's default browser somehow is confused when tapping on label which will lead to dragging the task

                //so disable dragging when clicking on label

                var agent = navigator.userAgent.toLowerCase();

                if("ontouchstart" in document && /applewebkit/.test(agent) && /android/.test(agent))

                  $('#tasks').on('touchstart', function(e){

                    var li = $(e.target).closest('#tasks li');

                    if(li.length == 0)return;

                    var label = li.find('label.inline').get(0);

                    if(label == e.target || $.contains(label, e.target)) e.stopImmediatePropagation() ;

                });

            

                $('#tasks').sortable({

                    opacity:0.8,

                    revert:true,

                    forceHelperSize:true,

                    placeholder: 'draggable-placeholder',

                    forcePlaceholderSize:true,

                    tolerance:'pointer',

                    stop: function( event, ui ) {//just for Chrome!!!! so that dropdowns on items don't appear below other items after being moved

                        $(ui.item).css('z-index', 'auto');

                    }

                    }

                );

                $('#tasks').disableSelection();

                $('#tasks input:checkbox').removeAttr('checked').on('click', function(){

                    if(this.checked) $(this).closest('li').addClass('selected');

                    else $(this).closest('li').removeClass('selected');

                });

                

            

            })

        </script>

   <!-- <div style="display:none"><script src='http://v7.cnzz.com/stat.php?id=155540&web_id=155540' language='JavaScript' charset='gb2312'></script></div> -->

</body>



<script>


///////////////////////////////////////////////////////////////////////
/*load old data
function MyAutoRun(){
    if ("{{error_info}}"){
        alert("{{error_info}}")
    }
    var hostlist = "{{host}}";
    var grouplist = "{{group}}";
    alert(grouplist);
    fillhost(hostlist);
    fillgroup(grouplist);
}
window.onload=MyAutoRun();
*/

$("input:text").bind("input propertychange",function(){
    //模态框隐藏事件
    $('#addhost').on('hidden.bs.modal',function(e){
        $('#host_1').val('');
        $('#host_2').val('');
        $('#host_3').val('');
        $('#host_4').val('');
        $('#host_5').val('');
        //$('#host_6').html('<span input-group-addon" style="width:200px;text-align:left">选择分组</span>');
    });
    
    $('#addgroup').on('hidden.bs.modal',function(e){
        $('#group_1').val('');
    });
    
    $('#modifyhost').on('hidden.bs.modal',function(e){
        $('#singlehost_1').val('');
        $('#singlehost_2').val('');
        $('#singlehost_3').val('');
        $('#singlehost_4').val('');
        $('#singlehost_5').val('');
        //$('#singlehost_6').html('<span input-group-addon" style="width:200px;text-align:left">选择分组</span>');
    });
    
});


//获取host, group列表
function gethost(){
    $.ajax({
        url:'/monitor_get_list/',
        type:'post',
        data:{},
        success:function(data,status){
            if(data[0]){
                setTimeout(function(){alert(data[0]);},200);
            }
            var hostlist = data[1];
            var grouplist = data[2];
            fillhost(hostlist);
            fillgroup(grouplist);
        },
        error:function(xhr, errorInfo, errorThrown){
            console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
        }
    });
}
window.onload=gethost();


//填充host列表
function fillhost(hostlist){
    $('#hostlist tr').remove();
    if(hostlist.length){
        for(var i=0;i<hostlist.length;i++){
            var tr = $('<tr></tr>');
            
            //id=hostlist[i].index
            //var td = $('<th class="center"><label><input type="checkbox" class="ace" id="chkall" /><span class="lbl"></span></label></th>'+'<td class="hidden-480">'+hostlist[i].hostip+'</td><td class="hidden-480">'+hostlist[i].group+'</td><td class="hidden-480">'+hostlist[i].zabbixagent+'<td class="hidden-480">'+hostlist[i].elkagent+'</td><td class="hidden-480"><a href="javascript:void(0)" onclick="deletehost(\''+hostlist[i].hostip+'\')">删除</a></td>');
            var td = $('<td width="5%">'+hostlist[i].index
            +'</td><td width="15%">'+hostlist[i].hostname
            +'</td><td width="15%">'+hostlist[i].hostip
            +'</td><td width="15%">'+hostlist[i].group
            +'</td><td width="12%">'+hostlist[i].zabbixagent
            +'</td><td width="12%">'+hostlist[i].elkagent
            +'</td><td width="26%"><a href="javascript:void(0)" type="button" data-toggle="modal" data-target="#modifyhostinfo" data-show="true" onclick="modifyhostinfo(\''+hostlist[i].hostip+'\')">修改</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="deletehost(\''+hostlist[i].hostip+'\')">删除</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="#deletehost(\''+hostlist[i].hostip+'\')">zabbix安装</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:void(0)" onclick="#deletehost(\''+hostlist[i].hostip+'\')">elk安装</a></td>');

            tr.append(td);
            $('#hostlist').append(tr);
        }
    }
    //定位页数
    var currentpage = parseInt($('.pagination a[href="#"]').text());
    var totlepage = $('#hostlist tr').length/10;
    totlepage = (totlepage==parseInt(totlepage))?totlepage:(parseInt(totlepage)+1);
    if( totlepage >= currentpage ){
        //goPage(currentpage,10,'idData');
    }else{
        //goPage(totlepage,10,'idData');
    }
}

//填充group列表
function fillgroup(grouplist){
    var selectGroup = document.getElementById('host_6');
    if(selectGroup.hasChildNodes()){
        selectGroup.innerHTML = '';
    }
    for(var i=0;i<grouplist.length;i++){
        var group = grouplist[i];
        var optionDom = document.createElement('option');
        optionDom.text = group;
        //var s = i.toString();
        //optionDom.id = 'wl_ms' + i.toString();
        selectGroup.appendChild(optionDom);
    }
    var selectGroup = document.getElementById('singlehost_6');
    if(selectGroup.hasChildNodes()){
        selectGroup.innerHTML = '';
    }
    for(var i=0;i<grouplist.length;i++){
        var group = grouplist[i];
        var optionDom = document.createElement('option');
        optionDom.text = group;
        //var s = i.toString();
        //optionDom.id = 'wl_ms' + i.toString();
        selectGroup.appendChild(optionDom);
    }
    var selectGroup = document.getElementById('group_2');
    if(selectGroup.hasChildNodes()){
        selectGroup.innerHTML = '';
    }
    for(var i=0;i<grouplist.length;i++){
        var group = grouplist[i];
        var optionDom = document.createElement('option');
        optionDom.text = group;
        //var s = i.toString();
        //optionDom.id = 'wl_ms' + i.toString();
        selectGroup.appendChild(optionDom);
    }
}

//添加host
function addhost(){
    var hostname = $('#host_1').val();
    var hostip = $('#host_2').val();
    var hostuser = $('#host_3').val();
    var hostpasswd = $('#host_4').val();
    var hostport = $('#host_5').val();
    var hostgroup = $('#host_6').val();
    if(hostip==''){
        alert('请输入主机IP地址！');
    }else if(hostuser==''){
        alert('请输入主机用户名！');
    }else if(hostpasswd==''){
        alert('请输入主机密码！');
    }else if(hostport==''){
        alert('请输入主机端口！');
    }else if(!hostgroup){
        alert('请输选择分组！');
    }else{
        var url = '/monitor_host_add/';
        $('#addhost').modal('hide');
        //maskLayer();
        $.ajax({
            url:url,
            type:'post',
            data:{hostname:hostname, hostip:hostip, hostuser:hostuser, hostpasswd:hostpasswd, hostport:hostport, hostgroup:hostgroup},
            success:function(data,status){
                //maskClose();    
                if(data[0]){
                    setTimeout(function(){alert(data[0]);},100);
                }
                var hostlist = data[1];
                var grouplist = data[2];
                fillhost(hostlist);
                fillgroup(grouplist);
            },
            error:function(xhr, errorInfo, errorThrown){
                console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
            }
        });
    }
}


//修改host配置信息，获取原配置信息
function modifyhostinfo(hostip){
    $('#modifyhost').modal('hide');
    $.ajax({
        url:'/monitor_singlehost_info/',
        type:'post',
        data:{hostip:hostip},
        success:function(data,status){
            if(data[0]){
                setTimeout(function(){alert(data[0]);},200);
            }
            else{
                var hostinfo = data[1];
                var txt1=document.getElementById('singlehost_1');
                txt1.value=hostinfo.hostname;
                var txt1=document.getElementById('singlehost_2');
                txt1.value=hostinfo.hostip;
                var txt1=document.getElementById('singlehost_3');
                txt1.value=hostinfo.hostuser;
                var txt1=document.getElementById('singlehost_4');
                txt1.value=hostinfo.hostpasswd;
                var txt1=document.getElementById('singlehost_5');
                txt1.value=hostinfo.hostport;
                var txt1=document.getElementById('singlehost_6');
                txt1.value=hostinfo.hostgroup;
                }
            },
        error:function(xhr, errorInfo, errorThrown){
            console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
        }
    });
}


//修改host配置信息，执行修改操作
function modifyhost(hostip){
    var hostname = $('#singlehost_1').val();
    var hostip = $('#singlehost_2').val();
    var hostuser = $('#singlehost_3').val();
    var hostpasswd = $('#singlehost_4').val();
    var hostport = $('#singlehost_5').val();
    var hostgroup = $('#singlehost_6').val();
    if(hostip==''){
        alert('请输入主机IP地址！');
    }else if(hostuser==''){
        alert('请输入主机用户名！');
    }else if(hostpasswd==''){
        alert('请输入主机密码！');
    }else if(hostport==''){
        alert('请输入主机端口！');
    }else if(!hostgroup){
        alert('请输选择分组！');
    }else{
        var url = '/monitor_singlehost_modify/';
        //$('#modifyhost').modal('hide');
        //maskLayer();
        $.ajax({
            url:url,
            type:'post',
            data:{hostname:hostname, hostip:hostip, hostuser:hostuser, hostpasswd:hostpasswd, hostport:hostport, hostgroup:hostgroup},
            success:function(data,status){
                //maskClose();    
                if(data[0]){
                    setTimeout(function(){alert(data[0]);},100);
                }
                var hostlist = data[1];
                var grouplist = data[2];
                fillhost(hostlist);
                fillgroup(grouplist);
            },
            error:function(xhr, errorInfo, errorThrown){
                console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
            }
        });
    }
}


//删除host
function deletehost(hostip){
    var url = '/monitor_host_del/';
    //maskLayer();
    $.ajax({
        url:url,
        type:'post',
        data:{hostip:hostip},
        success:function(data,status){
            //maskClose();    
            if(data[0]){
                setTimeout(function(){alert(data[0]);},100);
            }
            var hostlist = data[1];
            var grouplist = data[2];
            fillhost(hostlist);
            fillgroup(grouplist);
        },
        error:function(xhr, errorInfo, errorThrown){
            console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
        }
    });
}


//添加group
function addgroup(){
    var groupname = $('#group_1').val();
    if(groupname==''){
        alert('请输入组名！');
    }else{
        var url = '/monitor_group_add/';
        $('#addgroup').modal('hide');
        //$('#group_1').val('');
        //maskLayer();
        $.ajax({
            url:url,
            type:'post',
            data:{groupname:groupname},
            success:function(data,status){
                //maskClose();
                if(data[0]){
                    setTimeout(function(){alert(data[0]);},100);
                }
                var hostlist = data[1];
                var grouplist = data[2];
                fillhost(hostlist);
                fillgroup(grouplist);
            },
            error:function(xhr, errorInfo, errorThrown){
                console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
            }
        });
    }
}


//删除group
function delgroup(){
    var groupname = $('#group_2').val();
    if(groupname==''){
        alert('请输入组名！');
    }else{
        var url = '/monitor_group_del/';
        //$('#delgroup').modal('hide');
        //$('#group_1').val('');
        //maskLayer();
        $.ajax({
            url:url,
            type:'post',
            data:{groupname:groupname},
            success:function(data,status){
                //maskClose();
                if(data[0]){
                    setTimeout(function(){alert(data[0]);},100);
                }
                var hostlist = data[1];
                var grouplist = data[2];
                fillhost(hostlist);
                fillgroup(grouplist);
            },
            error:function(xhr, errorInfo, errorThrown){
                console.log('http状态：'+xhr.status+'，状态描述：'+xhr.statusText+'，错误信息：'+errorInfo);
            }
        });
    }
}

</script>


</html>



